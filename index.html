<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏û‡∏∞‡πÄ‡∏¢‡∏≤‡∏£‡∏≤‡∏°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #e0f2fe 0%, #b3e5fc 100%);
        }
        .card-gradient {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        .sidebar-gradient {
            background: linear-gradient(180deg, #ffffff 0%, #f1f5f9 100%);
        }
        
        /* Hamburger Animation */
        .hamburger-active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .hamburger-active .hamburger-line:nth-child(2) {
            opacity: 0;
        }
        .hamburger-active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
    </style>
</head>
<body class="gradient-bg min-h-full">
    <div class="flex h-full">
        <!-- Mobile Menu Button -->
        <button id="mobileMenuBtn" class="fixed top-4 left-4 z-50 md:hidden bg-blue-600 text-white p-3 rounded-lg shadow-lg hover:bg-blue-700 transition-colors">
            <div class="w-6 h-6 flex flex-col justify-center items-center">
                <span class="hamburger-line block w-6 h-0.5 bg-white mb-1 transition-all duration-300"></span>
                <span class="hamburger-line block w-6 h-0.5 bg-white mb-1 transition-all duration-300"></span>
                <span class="hamburger-line block w-6 h-0.5 bg-white transition-all duration-300"></span>
            </div>
        </button>

        <!-- Sidebar -->
        <div id="sidebar" class="w-64 sidebar-gradient shadow-lg transform -translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out fixed md:relative z-40 h-full">
            <div class="p-6">
                <h1 class="text-2xl font-bold text-blue-800 mb-8 mt-12 md:mt-0">üçú ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£<br>‡∏û‡∏∞‡πÄ‡∏¢‡∏≤‡∏£‡∏≤‡∏°</h1>
                <nav class="space-y-3">
                    <button onclick="showPage('dashboard')" class="w-full text-left px-4 py-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors">
                        üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                    </button>
                    <button onclick="showAddProductPage()" class="w-full text-left px-4 py-3 rounded-lg bg-green-500 text-white hover:bg-green-600 transition-colors">
                        üîº ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                    </button>
                    <button onclick="showPage('payment')" class="w-full text-left px-4 py-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors">
                        üí∏ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                    </button>
                    <button onclick="showReportPage()" class="w-full text-left px-4 py-3 rounded-lg bg-green-500 text-white hover:bg-green-600 transition-colors">
                        üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢
                    </button>
                </nav>
            </div>
        </div>

        <!-- Mobile Overlay -->
        <div id="mobileOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 md:hidden hidden"></div>

        <!-- Main Content -->
        <div class="flex-1 p-6 md:p-6 pt-20 md:pt-6">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page">
                <h2 class="text-3xl font-bold text-blue-800 mb-6">üìä Dashboard</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">üí∞ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
                        <p class="text-3xl font-bold text-green-600" id="todaySales">0 ‡∏ø</p>
                    </div>
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">üè¶ ‡∏¢‡∏≠‡∏î‡πÇ‡∏≠‡∏ô</h3>
                        <p class="text-3xl font-bold text-blue-600" id="transferSales">0 ‡∏ø</p>
                    </div>
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">üíµ ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</h3>
                        <p class="text-3xl font-bold text-orange-600" id="cashSales">0 ‡∏ø</p>
                    </div>
                </div>
                <div class="card-gradient p-6 rounded-lg shadow-md">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</h3>
                    <canvas id="salesChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- Add Product Page -->
            <div id="addProduct" class="page hidden">
                <h2 class="text-3xl font-bold text-blue-800 mb-6">üîº ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                <div class="card-gradient p-6 rounded-lg shadow-md max-w-2xl">
                    <form id="productForm" class="space-y-4">
                        <div>
                            <label for="productName" class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                            <input type="text" id="productName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label for="productDescription" class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                            <textarea id="productDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div>
                            <label for="productPrice" class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                            <input type="number" id="productPrice" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label for="productStock" class="block text-sm font-medium text-gray-700 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
                            <input type="number" id="productStock" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div class="flex space-x-4">
                            <button type="submit" class="px-6 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors">
                                üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                            </button>
                            <button type="button" onclick="saveToGoogleSheet('products')" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">
                                üì§ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Google Sheet
                            </button>
                            <button type="button" onclick="loadFromGoogleSheet('products')" class="px-6 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 transition-colors">
                                üì• ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Google Sheet
                            </button>
                        </div>
                    </form>
                </div>
                <div class="mt-8">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                    <div id="productList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                </div>
            </div>

            <!-- Payment Page -->
            <div id="payment" class="page hidden">
                <h2 class="text-3xl font-bold text-blue-800 mb-6">üí∏ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-4">üçΩÔ∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h3>
                        <div id="menuItems" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"></div>
                    </div>
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-semibold text-gray-700 mb-4">üßæ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
                        <div id="orderList" class="mb-4 space-y-2"></div>
                        <div class="border-t pt-4">
                            <div class="flex justify-between text-xl font-bold mb-4">
                                <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</span>
                                <span id="totalAmount">0 ‡∏ø</span>
                            </div>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
                                    <select id="paymentMethod" onchange="togglePaymentFields()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="cash">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</option>
                                        <option value="transfer">‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏≠‡∏ô</option>
                                    </select>
                                </div>
                                <div id="cashPayment">
                                    <label for="paidAmount" class="block text-sm font-medium text-gray-700 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢</label>
                                    <input type="number" id="paidAmount" oninput="calculateChange()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <div class="mt-2">
                                        <span class="text-lg font-semibold">‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô: </span>
                                        <span id="changeAmount" class="text-lg font-bold text-green-600">0 ‡∏ø</span>
                                    </div>
                                </div>
                                <div id="transferPayment" class="hidden">
                                    <p class="text-lg font-semibold text-blue-600">‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏≠‡∏ô: <span id="transferAmount">0 ‡∏ø</span></p>
                                </div>
                                <button onclick="confirmPayment()" class="w-full px-6 py-3 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors text-lg font-semibold">
                                    ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Report Page -->
            <div id="report" class="page hidden">
                <h2 class="text-3xl font-bold text-blue-800 mb-6">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">üí∞ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</h3>
                        <p class="text-2xl font-bold text-green-600" id="reportTotalSales">0 ‡∏ø</p>
                    </div>
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">üíµ ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</h3>
                        <p class="text-2xl font-bold text-orange-600" id="reportCashSales">0 ‡∏ø</p>
                    </div>
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">üè¶ ‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏≠‡∏ô</h3>
                        <p class="text-2xl font-bold text-blue-600" id="reportTransferSales">0 ‡∏ø</p>
                    </div>
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">üì¶ ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <p class="text-2xl font-bold text-purple-600" id="reportTotalOrders">0</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-semibold text-gray-700 mb-4">üî• ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</h3>
                        <div id="topSellingItems"></div>
                    </div>
                    <div class="card-gradient p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-semibold text-gray-700 mb-4">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</h3>
                        <canvas id="reportChart" width="400" height="300"></canvas>
                    </div>
                </div>
                <div class="mt-6 flex space-x-4">
                    <button onclick="saveToGoogleSheet('sales')" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">
                        üì§ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏ô Google Sheet
                    </button>
                    <button onclick="loadFromGoogleSheet('sales')" class="px-6 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 transition-colors">
                        üì• ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Google Sheet
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let products = JSON.parse(localStorage.getItem('products')) || [];
        let sales = JSON.parse(localStorage.getItem('sales')) || [];
        let currentOrder = [];
        let salesChart, reportChart;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            showPage('dashboard');
            loadProducts();
            updateDashboard();
            initCharts();
            initMobileMenu();
        });

        // Mobile menu functionality
        function initMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.getElementById('sidebar');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            mobileMenuBtn.addEventListener('click', toggleMobileMenu);
            mobileOverlay.addEventListener('click', closeMobileMenu);
            
            // Close menu when clicking on navigation items on mobile
            const navButtons = sidebar.querySelectorAll('button');
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    if (window.innerWidth < 768) {
                        closeMobileMenu();
                    }
                });
            });
        }

        function toggleMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.getElementById('sidebar');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            const isOpen = sidebar.classList.contains('translate-x-0');
            
            if (isOpen) {
                closeMobileMenu();
            } else {
                openMobileMenu();
            }
        }

        function openMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.getElementById('sidebar');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.remove('-translate-x-full');
            sidebar.classList.add('translate-x-0');
            mobileOverlay.classList.remove('hidden');
            mobileMenuBtn.classList.add('hamburger-active');
            document.body.style.overflow = 'hidden';
        }

        function closeMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.getElementById('sidebar');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.remove('translate-x-0');
            sidebar.classList.add('-translate-x-full');
            mobileOverlay.classList.add('hidden');
            mobileMenuBtn.classList.remove('hamburger-active');
            document.body.style.overflow = '';
        }

        // Page navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(pageId).classList.remove('hidden');
            
            if (pageId === 'payment') {
                displayMenuItems();
            } else if (pageId === 'report') {
                updateReport();
            }
        }

        // Show Add Product page with password protection
        function showAddProductPage() {
            Swal.fire({
                title: 'üîê ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô',
                text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤',
                input: 'password',
                inputPlaceholder: '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô',
                showCancelButton: true,
                confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                confirmButtonColor: '#10b981',
                cancelButtonColor: '#6b7280',
                inputValidator: (value) => {
                    if (!value) {
                        return '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô';
                    }
                    if (value !== 'pyr054411111') {
                        return '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                    }
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        icon: 'success',
                        title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        text: '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤',
                        timer: 1500,
                        showConfirmButton: false
                    }).then(() => {
                        showPage('addProduct');
                    });
                }
            });
        }

        // Show Report page with password protection
        function showReportPage() {
            Swal.fire({
                title: 'üîê ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô',
                text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢',
                input: 'password',
                inputPlaceholder: '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô',
                showCancelButton: true,
                confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                confirmButtonColor: '#10b981',
                cancelButtonColor: '#6b7280',
                inputValidator: (value) => {
                    if (!value) {
                        return '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô';
                    }
                    if (value !== 'pyr054411111') {
                        return '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                    }
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        icon: 'success',
                        title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        text: '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢',
                        timer: 1500,
                        showConfirmButton: false
                    }).then(() => {
                        showPage('report');
                    });
                }
            });
        }

        // Product management
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const product = {
                id: Date.now(),
                name: document.getElementById('productName').value,
                description: document.getElementById('productDescription').value,
                price: parseFloat(document.getElementById('productPrice').value),
                stock: parseInt(document.getElementById('productStock').value)
            };
            
            products.push(product);
            localStorage.setItem('products', JSON.stringify(products));
            
            Swal.fire({
                icon: 'success',
                title: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                text: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                timer: 1500,
                showConfirmButton: false
            });
            
            this.reset();
            loadProducts();
        });

        function loadProducts() {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'card-gradient p-4 rounded-lg shadow-md';
                productCard.innerHTML = `
                    <h4 class="font-semibold text-lg mb-2">${product.name}</h4>
                    <p class="text-gray-600 mb-2">${product.description}</p>
                    <p class="text-green-600 font-bold mb-2">${product.price} ‡∏ø</p>
                    <p class="text-sm text-gray-500">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${product.stock} ‡∏ä‡∏¥‡πâ‡∏ô</p>
                    <div class="mt-2 flex space-x-2">
                        <button onclick="editProduct(${product.id})" class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-sm">
                            ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        </button>
                        <button onclick="deleteProduct(${product.id})" class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors text-sm">
                            üóëÔ∏è ‡∏•‡∏ö
                        </button>
                    </div>
                `;
                productList.appendChild(productCard);
            });
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;

            Swal.fire({
                title: '‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤',
                html: `
                    <div class="space-y-4 text-left">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                            <input type="text" id="editProductName" value="${product.name}" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                            <textarea id="editProductDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">${product.description}</textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                            <input type="number" id="editProductPrice" value="${product.price}" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
                            <input type="number" id="editProductStock" value="${product.stock}" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                confirmButtonColor: '#10b981',
                cancelButtonColor: '#6b7280',
                width: '500px',
                preConfirm: () => {
                    const name = document.getElementById('editProductName').value;
                    const description = document.getElementById('editProductDescription').value;
                    const price = parseFloat(document.getElementById('editProductPrice').value);
                    const stock = parseInt(document.getElementById('editProductStock').value);

                    if (!name || !price || !stock) {
                        Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                        return false;
                    }

                    if (price <= 0 || stock < 0) {
                        Swal.showValidationMessage('‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                        return false;
                    }

                    return { name, description, price, stock };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const updatedData = result.value;
                    
                    // Update product
                    product.name = updatedData.name;
                    product.description = updatedData.description;
                    product.price = updatedData.price;
                    product.stock = updatedData.stock;

                    localStorage.setItem('products', JSON.stringify(products));
                    loadProducts();
                    displayMenuItems();

                    Swal.fire({
                        icon: 'success',
                        title: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏•‡πâ‡∏ß',
                        timer: 1500,
                        showConfirmButton: false
                    });
                }
            });
        }

        function deleteProduct(id) {
            Swal.fire({
                title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?',
                text: '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: '‡∏•‡∏ö',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
            }).then((result) => {
                if (result.isConfirmed) {
                    products = products.filter(p => p.id !== id);
                    localStorage.setItem('products', JSON.stringify(products));
                    loadProducts();
                    displayMenuItems();
                    Swal.fire('‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß!', '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
                }
            });
        }

        // Payment system
        function displayMenuItems() {
            const menuItems = document.getElementById('menuItems');
            menuItems.innerHTML = '';
            
            products.forEach(product => {
                if (product.stock > 0) {
                    const menuCard = document.createElement('div');
                    menuCard.className = 'card-gradient p-4 rounded-lg shadow-md cursor-pointer hover:shadow-lg transition-shadow';
                    menuCard.onclick = () => addToOrder(product);
                    menuCard.innerHTML = `
                        <h4 class="font-semibold text-lg mb-2">${product.name}</h4>
                        <p class="text-gray-600 mb-2">${product.description}</p>
                        <p class="text-green-600 font-bold">${product.price} ‡∏ø</p>
                        <p class="text-sm text-gray-500">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${product.stock} ‡∏ä‡∏¥‡πâ‡∏ô</p>
                    `;
                    menuItems.appendChild(menuCard);
                }
            });
        }

        function addToOrder(product) {
            const existingItem = currentOrder.find(item => item.id === product.id);
            
            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity++;
                } else {
                    Swal.fire('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ', '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠', 'warning');
                    return;
                }
            } else {
                currentOrder.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    quantity: 1
                });
            }
            
            updateOrderDisplay();
        }

        function removeFromOrder(productId) {
            const itemIndex = currentOrder.findIndex(item => item.id === productId);
            if (itemIndex > -1) {
                if (currentOrder[itemIndex].quantity > 1) {
                    currentOrder[itemIndex].quantity--;
                } else {
                    currentOrder.splice(itemIndex, 1);
                }
            }
            updateOrderDisplay();
        }

        function updateOrderDisplay() {
            const orderList = document.getElementById('orderList');
            orderList.innerHTML = '';
            
            let total = 0;
            
            currentOrder.forEach(item => {
                const orderItem = document.createElement('div');
                orderItem.className = 'flex justify-between items-center bg-gray-50 p-2 rounded';
                orderItem.innerHTML = `
                    <div>
                        <span class="font-medium">${item.name}</span>
                        <span class="text-gray-600"> x${item.quantity}</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="font-bold">${item.price * item.quantity} ‡∏ø</span>
                        <button onclick="removeFromOrder(${item.id})" class="text-red-500 hover:text-red-700">
                            ‚ûñ
                        </button>
                    </div>
                `;
                orderList.appendChild(orderItem);
                total += item.price * item.quantity;
            });
            
            document.getElementById('totalAmount').textContent = total + ' ‡∏ø';
            document.getElementById('transferAmount').textContent = total + ' ‡∏ø';
            calculateChange();
        }

        function togglePaymentFields() {
            const method = document.getElementById('paymentMethod').value;
            const cashPayment = document.getElementById('cashPayment');
            const transferPayment = document.getElementById('transferPayment');
            
            if (method === 'cash') {
                cashPayment.classList.remove('hidden');
                transferPayment.classList.add('hidden');
            } else {
                cashPayment.classList.add('hidden');
                transferPayment.classList.remove('hidden');
            }
        }

        function calculateChange() {
            const total = currentOrder.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const paid = parseFloat(document.getElementById('paidAmount').value) || 0;
            const change = paid - total;
            
            document.getElementById('changeAmount').textContent = Math.max(0, change) + ' ‡∏ø';
        }

        function confirmPayment() {
            if (currentOrder.length === 0) {
                Swal.fire('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô', 'warning');
                return;
            }
            
            const total = currentOrder.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const method = document.getElementById('paymentMethod').value;
            const paid = parseFloat(document.getElementById('paidAmount').value) || 0;
            
            if (method === 'cash' && paid < total) {
                Swal.fire('‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'warning');
                return;
            }
            
            // Update stock
            currentOrder.forEach(orderItem => {
                const product = products.find(p => p.id === orderItem.id);
                if (product) {
                    product.stock -= orderItem.quantity;
                }
            });
            
            // Save sale record
            const sale = {
                id: Date.now(),
                date: new Date().toISOString(),
                items: [...currentOrder],
                total: total,
                method: method,
                paid: method === 'cash' ? paid : total,
                change: method === 'cash' ? Math.max(0, paid - total) : 0
            };
            
            sales.push(sale);
            localStorage.setItem('products', JSON.stringify(products));
            localStorage.setItem('sales', JSON.stringify(sales));
            
            Swal.fire({
                icon: 'success',
                title: '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                text: `‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${total} ‡∏ø${method === 'cash' ? ` | ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô: ${sale.change} ‡∏ø` : ''}`,
                timer: 2000,
                showConfirmButton: false
            });
            
            // Reset order
            currentOrder = [];
            updateOrderDisplay();
            displayMenuItems();
            updateDashboard();
            document.getElementById('paidAmount').value = '';
            document.getElementById('changeAmount').textContent = '0 ‡∏ø';
        }

        // Dashboard and reporting
        function updateDashboard() {
            const today = new Date().toDateString();
            const todaySales = sales.filter(sale => new Date(sale.date).toDateString() === today);
            
            const totalToday = todaySales.reduce((sum, sale) => sum + sale.total, 0);
            const cashToday = todaySales.filter(sale => sale.method === 'cash').reduce((sum, sale) => sum + sale.total, 0);
            const transferToday = todaySales.filter(sale => sale.method === 'transfer').reduce((sum, sale) => sum + sale.total, 0);
            
            document.getElementById('todaySales').textContent = totalToday + ' ‡∏ø';
            document.getElementById('cashSales').textContent = cashToday + ' ‡∏ø';
            document.getElementById('transferSales').textContent = transferToday + ' ‡∏ø';
            
            updateSalesChart();
        }

        function updateReport() {
            const totalSales = sales.reduce((sum, sale) => sum + sale.total, 0);
            const cashSales = sales.filter(sale => sale.method === 'cash').reduce((sum, sale) => sum + sale.total, 0);
            const transferSales = sales.filter(sale => sale.method === 'transfer').reduce((sum, sale) => sum + sale.total, 0);
            
            document.getElementById('reportTotalSales').textContent = totalSales + ' ‡∏ø';
            document.getElementById('reportCashSales').textContent = cashSales + ' ‡∏ø';
            document.getElementById('reportTransferSales').textContent = transferSales + ' ‡∏ø';
            document.getElementById('reportTotalOrders').textContent = sales.length;
            
            updateTopSellingItems();
            updateReportChart();
        }

        function updateTopSellingItems() {
            const itemSales = {};
            
            sales.forEach(sale => {
                sale.items.forEach(item => {
                    if (itemSales[item.name]) {
                        itemSales[item.name] += item.quantity;
                    } else {
                        itemSales[item.name] = item.quantity;
                    }
                });
            });
            
            const sortedItems = Object.entries(itemSales)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5);
            
            const topSellingDiv = document.getElementById('topSellingItems');
            topSellingDiv.innerHTML = '';
            
            sortedItems.forEach(([name, quantity], index) => {
                const item = document.createElement('div');
                item.className = 'flex justify-between items-center py-2 border-b';
                item.innerHTML = `
                    <span>${index + 1}. ${name}</span>
                    <span class="font-bold text-green-600">${quantity} ‡∏ä‡∏¥‡πâ‡∏ô</span>
                `;
                topSellingDiv.appendChild(item);
            });
        }

        function initCharts() {
            // Dashboard Chart
            const ctx1 = document.getElementById('salesChart').getContext('2d');
            salesChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô',
                        data: [],
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Report Chart
            const ctx2 = document.getElementById('reportChart').getContext('2d');
            reportChart = new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: ['‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î', '‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏≠‡∏ô'],
                    datasets: [{
                        data: [0, 0],
                        backgroundColor: ['#f97316', '#3b82f6']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function updateSalesChart() {
            const last7Days = [];
            const salesData = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateString = date.toDateString();
                
                last7Days.push(date.toLocaleDateString('th-TH', { month: 'short', day: 'numeric' }));
                
                const daySales = sales.filter(sale => new Date(sale.date).toDateString() === dateString);
                const dayTotal = daySales.reduce((sum, sale) => sum + sale.total, 0);
                salesData.push(dayTotal);
            }
            
            salesChart.data.labels = last7Days;
            salesChart.data.datasets[0].data = salesData;
            salesChart.update();
        }

        function updateReportChart() {
            const cashSales = sales.filter(sale => sale.method === 'cash').reduce((sum, sale) => sum + sale.total, 0);
            const transferSales = sales.filter(sale => sale.method === 'transfer').reduce((sum, sale) => sum + sale.total, 0);
            
            reportChart.data.datasets[0].data = [cashSales, transferSales];
            reportChart.update();
        }

        // Google Sheets integration
        function saveToGoogleSheet(type) {
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            let data;
            if (type === 'products') {
                data = {
                    type: 'products',
                    data: products
                };
            } else if (type === 'sales') {
                data = {
                    type: 'sales',
                    data: sales
                };
            }

            // JSONP request to Google Apps Script
            const script = document.createElement('script');
            const callbackName = 'callback_' + Date.now();
            
            window[callbackName] = function(response) {
                document.head.removeChild(script);
                delete window[callbackName];
                
                if (response.success) {
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Google Sheet ‡πÅ‡∏•‡πâ‡∏ß',
                        timer: 2000,
                        showConfirmButton: false
                    });
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!',
                        text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ'
                    });
                }
            };

            const params = new URLSearchParams({
                callback: callbackName,
                data: JSON.stringify(data)
            });

            script.src = `https://script.google.com/macros/s/AKfycbwpbYhxQlytmePrpBkbumN_V8E8DqJvZcA2caUNG60dhHFbEYEr60mPTe8DS7IEHkUVuA/exec?${params}`;
            document.head.appendChild(script);

            // Timeout handling
            setTimeout(() => {
                if (window[callbackName]) {
                    document.head.removeChild(script);
                    delete window[callbackName];
                    Swal.fire({
                        icon: 'error',
                        title: '‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤!',
                        text: '‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
                    });
                }
            }, 10000);
        }

        function loadFromGoogleSheet(type) {
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });

            // JSONP request to Google Apps Script
            const script = document.createElement('script');
            const callbackName = 'loadCallback_' + Date.now();
            
            window[callbackName] = function(response) {
                document.head.removeChild(script);
                delete window[callbackName];
                
                if (response.success && response.data) {
                    if (type === 'products') {
                        products = response.data;
                        localStorage.setItem('products', JSON.stringify(products));
                        loadProducts();
                        displayMenuItems();
                    } else if (type === 'sales') {
                        sales = response.data;
                        localStorage.setItem('sales', JSON.stringify(sales));
                        updateDashboard();
                        updateReport();
                    }
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏•‡πâ‡∏ß',
                        timer: 2000,
                        showConfirmButton: false
                    });
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!',
                        text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ'
                    });
                }
            };

            const params = new URLSearchParams({
                callback: callbackName,
                action: 'load',
                type: type
            });

            script.src = `https://script.google.com/macros/s/AKfycbwpbYhxQlytmePrpBkbumN_V8E8DqJvZcA2caUNG60dhHFbEYEr60mPTe8DS7IEHkUVuA/exec?${params}`;
            document.head.appendChild(script);

            // Timeout handling
            setTimeout(() => {
                if (window[callbackName]) {
                    document.head.removeChild(script);
                    delete window[callbackName];
                    Swal.fire({
                        icon: 'error',
                        title: '‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤!',
                        text: '‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
                    });
                }
            }, 10000);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'992da09f5491a1b7',t:'MTc2MTE4NDY4Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
